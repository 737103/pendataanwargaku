(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{2748:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>b});var n=s(95155),i=s(12115),l=s(85174),t=s(3925),r=s(85127),c=s(90010),d=s(54165),h=s(66695),x=s(68856),o=s(30285),j=s(75074),u=s(68718),m=s(17607),g=s(75943),p=s(77223),f=s(87481),N=s(97419),k=s(47727),w=s(62523);function v(){let[e,a]=(0,i.useState)([]),[s,v]=(0,i.useState)(!0),[y,A]=(0,i.useState)(null),[b,C]=(0,i.useState)(null),[E,S]=(0,i.useState)(null),[_,D]=(0,i.useState)(!1),[K,z]=(0,i.useState)(!1),[H,L]=(0,i.useState)(!1),[I,M]=(0,i.useState)(""),[O,P]=(0,i.useState)(1),{toast:W}=(0,f.dj)(),T=async()=>{v(!0);try{let e=await (0,l.wO)();a(e)}catch(e){console.error("Failed to fetch citizens:",e),W({title:"Gagal Mengambil Data",description:"Tidak dapat mengambil daftar warga.",variant:"destructive"})}finally{v(!1)}};(0,i.useEffect)(()=>{T()},[]);let $=(0,i.useMemo)(()=>(P(1),I)?e.filter(e=>e.name.toLowerCase().includes(I.toLowerCase())||e.nik.includes(I)||e.kkNumber.includes(I)):e,[e,I]),R=Math.ceil($.length/5),B=(0,i.useMemo)(()=>{let e=(O-1)*5;return $.slice(e,e+5)},[$,O]),F=e=>{A(e),D(!0)},G=e=>{C(e),z(!0)},Z=e=>{S(e),L(!0)},V=async()=>{if(y)try{await (0,l.uV)(y.id),W({title:"Data Dihapus",description:'Data untuk "'.concat(y.name,'" telah berhasil dihapus.')}),T()}catch(e){console.error("Failed to delete citizen data:",e),W({title:"Gagal Menghapus",description:"Terjadi kesalahan saat menghapus data.",variant:"destructive"})}finally{D(!1),A(null)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(h.Zp,{children:[(0,n.jsx)(h.aR,{children:(0,n.jsx)(h.ZB,{children:"Daftar Warga"})}),(0,n.jsxs)(h.Wu,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4 gap-4",children:[(0,n.jsxs)("div",{className:"relative flex-grow",children:[(0,n.jsx)(j.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,n.jsx)(w.p,{placeholder:"Cari berdasarkan Nama, NIK, atau No. KK...",value:I,onChange:e=>M(e.target.value),className:"pl-10"})]}),(0,n.jsxs)(o.$,{onClick:()=>{let e=$.map(e=>({Nama:e.name,NIK:e.nik,"No. KK":e.kkNumber,"Hubungan Keluarga":e.familyRelationship,Alamat:e.address,"No. Telepon":e.contactInfo,"Jenis Kelamin":e.gender,Pekerjaan:e.occupation,"Pendidikan Terakhir":e.lastEducation,"Status Perkawinan":e.maritalStatus,Agama:e.religion,RT:e.rt,RW:e.rw,"Dientri oleh":e.username})),a=t.Wp.json_to_sheet(e),s=t.Wp.book_new();t.Wp.book_append_sheet(s,a,"Data Warga"),t._h(s,"data_warga.xlsx")},className:"bg-accent text-accent-foreground hover:bg-accent/90",disabled:s,children:[(0,n.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Download XLS"]})]}),(0,n.jsxs)(r.XI,{children:[(0,n.jsx)(r.A0,{children:(0,n.jsxs)(r.Hj,{children:[(0,n.jsx)(r.nd,{children:"Nama"}),(0,n.jsx)(r.nd,{children:"NIK"}),(0,n.jsx)(r.nd,{children:"No. KK"}),(0,n.jsx)(r.nd,{children:"Hubungan Keluarga"}),(0,n.jsx)(r.nd,{children:"Alamat"}),(0,n.jsx)(r.nd,{children:"No. Telepon"}),(0,n.jsx)(r.nd,{children:"Pengirim"}),(0,n.jsx)(r.nd,{className:"text-right",children:"Aksi"})]})}),(0,n.jsx)(r.BF,{children:s?Array.from({length:5}).map((e,a)=>(0,n.jsxs)(r.Hj,{children:[(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-32"})}),(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-36"})}),(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-36"})}),(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-24"})}),(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-48"})}),(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-28"})}),(0,n.jsx)(r.nA,{children:(0,n.jsx)(x.E,{className:"h-4 w-24"})}),(0,n.jsx)(r.nA,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(x.E,{className:"h-8 w-8"}),(0,n.jsx)(x.E,{className:"h-8 w-8"}),(0,n.jsx)(x.E,{className:"h-8 w-8"})]})})]},a)):B.length>0?B.map(e=>(0,n.jsxs)(r.Hj,{children:[(0,n.jsx)(r.nA,{className:"font-medium",children:e.name}),(0,n.jsx)(r.nA,{children:e.nik}),(0,n.jsx)(r.nA,{children:e.kkNumber}),(0,n.jsx)(r.nA,{children:e.familyRelationship}),(0,n.jsx)(r.nA,{children:e.address}),(0,n.jsx)(r.nA,{children:e.contactInfo}),(0,n.jsx)(r.nA,{children:e.username}),(0,n.jsx)(r.nA,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsxs)(o.$,{variant:"outline",size:"icon",onClick:()=>Z(e),title:"Lihat Detail",children:[(0,n.jsx)(m.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Lihat Detail"})]}),(0,n.jsxs)(o.$,{variant:"outline",size:"icon",onClick:()=>G(e),title:"Edit",children:[(0,n.jsx)(g.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,n.jsxs)(o.$,{variant:"destructive",size:"icon",onClick:()=>F(e),title:"Hapus",children:[(0,n.jsx)(p.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Hapus"})]})]})})]},e.id)):(0,n.jsx)(r.Hj,{children:(0,n.jsx)(r.nA,{colSpan:8,className:"h-24 text-center",children:I?'Tidak ada data yang cocok dengan "'.concat(I,'".'):"Tidak ada data warga yang dientri."})})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,n.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Halaman ",O," dari ",R]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>P(e=>Math.max(e-1,1)),disabled:1===O,children:"Sebelumnya"}),(0,n.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>P(e=>Math.min(e+1,R)),disabled:O===R,children:"Berikutnya"})]})]})]})]}),(0,n.jsx)(c.Lt,{open:_,onOpenChange:D,children:(0,n.jsxs)(c.EO,{children:[(0,n.jsxs)(c.wd,{children:[(0,n.jsx)(c.r7,{children:"Anda Yakin?"}),(0,n.jsxs)(c.$v,{children:['Tindakan ini akan menghapus data untuk "',null==y?void 0:y.name,'" secara permanen.']})]}),(0,n.jsxs)(c.ck,{children:[(0,n.jsx)(c.Zr,{children:"Batal"}),(0,n.jsx)(c.Rx,{onClick:V,children:"Hapus"})]})]})}),(0,n.jsx)(d.lG,{open:K,onOpenChange:z,children:(0,n.jsxs)(d.Cf,{className:"sm:max-w-[650px]",children:[(0,n.jsxs)(d.c7,{children:[(0,n.jsx)(d.L3,{children:"Edit Data Warga"}),(0,n.jsx)(d.rr,{children:"Lakukan perubahan pada data. Klik simpan jika sudah selesai."})]}),b&&(0,n.jsx)(N.P,{citizen:b,onSuccess:()=>{z(!1),C(null),T()}})]})}),(0,n.jsx)(d.lG,{open:H,onOpenChange:L,children:(0,n.jsxs)(d.Cf,{className:"sm:max-w-[650px]",children:[(0,n.jsxs)(d.c7,{children:[(0,n.jsx)(d.L3,{children:"Detail Data Warga"}),(0,n.jsx)(d.rr,{children:"Informasi lengkap mengenai warga yang dipilih."})]}),E&&(0,n.jsx)(k.F,{citizen:E})]})})]})}var y=s(35695),A=s(12543);function b(){let e=(0,y.useRouter)();return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold font-headline tracking-tight",children:"Data Warga"}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:"Berikut adalah daftar semua data warga yang telah dientri."}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(v,{})}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsxs)(o.$,{onClick:()=>e.push("/admin"),children:[(0,n.jsx)(A.A,{className:"mr-2 h-4 w-4"}),"Kembali"]})})]})}},12543:(e,a,s)=>{"use strict";s.d(a,{A:()=>n});let n=(0,s(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},30741:(e,a,s)=>{Promise.resolve().then(s.bind(s,2748))},32383:()=>{},66766:(e,a,s)=>{"use strict";s.d(a,{default:()=>i.a});var n=s(71469),i=s.n(n)},68718:(e,a,s)=>{"use strict";s.d(a,{A:()=>n});let n=(0,s(40157).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},71469:(e,a,s)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),!function(e,a){for(var s in a)Object.defineProperty(e,s,{enumerable:!0,get:a[s]})}(a,{default:function(){return c},getImageProps:function(){return r}});let n=s(88229),i=s(38883),l=s(33063),t=n._(s(51193));function r(e){let{props:a}=(0,i.getImgProps)(e,{defaultLoader:t.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,s]of Object.entries(a))void 0===s&&delete a[e];return{props:a}}let c=l.Image},83686:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[992,524,172,320,869,192,63,934,730,935,441,684,358],()=>a(30741)),_N_E=e.O()}]);