(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{13262:(e,a,l)=>{"use strict";l.d(a,{a:()=>r});var n=l(95155),s=l(66766);function r(){return(0,n.jsxs)("div",{className:"flex items-center gap-2 font-headline text-lg font-bold",children:[(0,n.jsx)("div",{className:"relative h-[80px] w-[80px]",children:(0,n.jsx)(s.default,{src:"/logo-wargadata.png",alt:"WargaKu Logo",fill:!0,className:"object-contain","data-ai-hint":"logo"})}),(0,n.jsx)("span",{children:"WargaKu"})]})}},19448:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>q});var n=l(95155),s=l(12115),r=l(83540),t=l(3401),i=l(94754),c=l(96025),d=l(16238),o=l(83394),u=l(54811),h=l(66695),x=l(94517),m=l(24026),g=l(59434);let j={light:"",dark:".dark"},p=s.createContext(null);function f(){let e=s.useContext(p);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let v=s.forwardRef((e,a)=>{let{id:l,className:t,children:i,config:c,...d}=e,o=s.useId(),u="chart-".concat(l||o.replace(/:/g,""));return(0,n.jsx)(p.Provider,{value:{config:c},children:(0,n.jsxs)("div",{"data-chart":u,ref:a,className:(0,g.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...d,children:[(0,n.jsx)(b,{id:u,config:c}),(0,n.jsx)(r.u,{children:i})]})})});v.displayName="Chart";let b=e=>{let{id:a,config:l}=e,s=Object.entries(l).filter(e=>{let[,a]=e;return a.theme||a.color});return s.length?(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(j).map(e=>{let[l,n]=e;return"\n".concat(n," [data-chart=").concat(a,"] {\n").concat(s.map(e=>{var a;let[n,s]=e,r=(null==(a=s.theme)?void 0:a[l])||s.color;return r?"  --color-".concat(n,": ").concat(r,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},k=x.m,N=s.forwardRef((e,a)=>{let{active:l,payload:r,className:t,indicator:i="dot",hideLabel:c=!1,hideIndicator:d=!1,label:o,labelFormatter:u,labelClassName:h,formatter:x,color:m,nameKey:j,labelKey:p}=e,{config:v}=f(),b=s.useMemo(()=>{var e;if(c||!(null==r?void 0:r.length))return null;let[a]=r,l="".concat(p||a.dataKey||a.name||"value"),s=w(v,a,l),t=p||"string"!=typeof o?null==s?void 0:s.label:(null==(e=v[o])?void 0:e.label)||o;return u?(0,n.jsx)("div",{className:(0,g.cn)("font-medium",h),children:u(t,r)}):t?(0,n.jsx)("div",{className:(0,g.cn)("font-medium",h),children:t}):null},[o,u,r,c,h,v,p]);if(!l||!(null==r?void 0:r.length))return null;let k=1===r.length&&"dot"!==i;return(0,n.jsxs)("div",{ref:a,className:(0,g.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",t),children:[k?null:b,(0,n.jsx)("div",{className:"grid gap-1.5",children:r.map((e,a)=>{let l="".concat(j||e.name||e.dataKey||"value"),s=w(v,e,l),r=m||e.payload.fill||e.color;return(0,n.jsx)("div",{className:(0,g.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:x&&(null==e?void 0:e.value)!==void 0&&e.name?x(e.value,e.name,e,a,e.payload):(0,n.jsxs)(n.Fragment,{children:[(null==s?void 0:s.icon)?(0,n.jsx)(s.icon,{}):!d&&(0,n.jsx)("div",{className:(0,g.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":k&&"dashed"===i}),style:{"--color-bg":r,"--color-border":r}}),(0,n.jsxs)("div",{className:(0,g.cn)("flex flex-1 justify-between leading-none",k?"items-end":"items-center"),children:[(0,n.jsxs)("div",{className:"grid gap-1.5",children:[k?b:null,(0,n.jsx)("span",{className:"text-muted-foreground",children:(null==s?void 0:s.label)||e.name})]}),e.value&&(0,n.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function w(e,a,l){if("object"!=typeof a||null===a)return;let n="payload"in a&&"object"==typeof a.payload&&null!==a.payload?a.payload:void 0,s=l;return l in a&&"string"==typeof a[l]?s=a[l]:n&&l in n&&"string"==typeof n[l]&&(s=n[l]),s in e?e[s]:e[l]}N.displayName="ChartTooltip",m.s,s.forwardRef((e,a)=>{let{className:l,hideIcon:s=!1,payload:r,verticalAlign:t="bottom",nameKey:i}=e,{config:c}=f();return(null==r?void 0:r.length)?(0,n.jsx)("div",{ref:a,className:(0,g.cn)("flex items-center justify-center gap-4","top"===t?"pb-3":"pt-3",l),children:r.map(e=>{let a="".concat(i||e.dataKey||"value"),l=w(c,e,a);return(0,n.jsxs)("div",{className:(0,g.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==l?void 0:l.icon)&&!s?(0,n.jsx)(l.icon,{}):(0,n.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==l?void 0:l.label]},e.value)})}):null}).displayName="ChartLegend";var y=l(50286),C=l(68510),A=l(18186),_=l(40320),K=l(85174),S=l(68856);let E={count:{label:"Data Dientri"},completed:{label:"Data Dientri (Lengkap)",color:"hsl(var(--chart-2))"},inProgress:{label:"Data Dientri (Proses)",color:"hsl(var(--primary))"}};function D(e){let{title:a,value:l,icon:s,loading:r}=e;return(0,n.jsxs)(h.Zp,{children:[(0,n.jsxs)(h.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(h.ZB,{className:"text-sm font-medium",children:a}),(0,n.jsx)(s,{className:"h-4 w-4 text-muted-foreground"})]}),(0,n.jsx)(h.Wu,{children:r?(0,n.jsx)(S.E,{className:"h-8 w-24"}):(0,n.jsx)("div",{className:"text-2xl font-bold",children:l})})]})}function L(){return(0,n.jsxs)("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground pt-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:"hsl(var(--primary))"}}),(0,n.jsx)("span",{children:"Entri Belum Lengkap"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:"hsl(var(--chart-2))"}}),(0,n.jsx)("span",{children:"Entri Lengkap"})]})]})}function R(){var e,a,l,x,m;let[g,j]=(0,s.useState)(null),[p,f]=(0,s.useState)(!0);(0,s.useEffect)(()=>{!async function(){try{f(!0);let e=await (0,K.wx)();j(e)}catch(e){console.error("Failed to fetch dashboard stats:",e)}finally{f(!1)}}()},[]);let b=(null==g?void 0:g.inputStats)||[];return(0,n.jsxs)("div",{className:"grid gap-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-5",children:[(0,n.jsx)(D,{title:"Jumlah Jiwa",value:null!=(e=null==g?void 0:g.totalSouls)?e:0,icon:y.A,loading:p}),(0,n.jsx)(D,{title:"Jumlah Laki-laki",value:null!=(a=null==g?void 0:g.totalMale)?a:0,icon:C.A,loading:p}),(0,n.jsx)(D,{title:"Jumlah Perempuan",value:null!=(l=null==g?void 0:g.totalFemale)?l:0,icon:C.A,loading:p}),(0,n.jsx)(D,{title:"Jumlah KK",value:null!=(x=null==g?void 0:g.totalKK)?x:0,icon:A.A,loading:p}),(0,n.jsx)(D,{title:"Anggota Belum Diinput",value:null!=(m=null==g?void 0:g.pendingMembers)?m:0,icon:_.A,loading:p})]}),(0,n.jsxs)(h.Zp,{children:[(0,n.jsxs)(h.aR,{children:[(0,n.jsx)(h.ZB,{children:"Aktivitas Penginputan per Pengguna"}),(0,n.jsx)(h.BT,{children:"Jumlah data warga yang dientri oleh setiap pengguna. Ungu menandakan penginputan belum lengkap, sementara hijau berarti penginputan sudah lengkap."})]}),(0,n.jsxs)(h.Wu,{children:[p?(0,n.jsx)("div",{className:"h-[300px] w-full flex items-center justify-center",children:(0,n.jsx)(S.E,{className:"h-full w-full"})}):(0,n.jsx)(v,{config:E,className:"min-h-[300px] w-full",children:(0,n.jsx)(r.u,{width:"100%",height:300,children:(0,n.jsxs)(t.E,{accessibilityLayer:!0,data:b,margin:{top:20,right:20,bottom:40,left:20},children:[(0,n.jsx)(i.d,{vertical:!1}),(0,n.jsx)(c.W,{dataKey:"username",tickLine:!1,tickMargin:10,axisLine:!1,angle:-45,textAnchor:"end"}),(0,n.jsx)(d.h,{allowDecimals:!1}),(0,n.jsx)(k,{cursor:!1,content:(0,n.jsx)(N,{indicator:"dashed"})}),(0,n.jsx)(o.y,{dataKey:"count",radius:4,children:b.map((e,a)=>(0,n.jsx)(u.f,{fill:e.isComplete?"hsl(var(--chart-2))":"hsl(var(--primary))"},"cell-".concat(a)))})]})})}),!p&&b.length>0&&(0,n.jsx)(L,{})]})]})]})}var P=l(30285),B=l(15300),M=l(10469),W=l(91721),F=l(33349),z=l(35695),O=l(13262),T=l(54165),H=l(62423),$=l(3925),I=l(85127),Z=l(87481),J=l(24944),G=l(68718);function X(){let[e,a]=(0,s.useState)([]),[l,r]=(0,s.useState)(!0),[t,i]=(0,s.useState)(5),{toast:c}=(0,Z.dj)();(0,s.useEffect)(()=>{(async()=>{r(!0);try{let e=await (0,K.wO)(),l=new Map;for(let a of e){l.has(a.kkNumber)||l.set(a.kkNumber,{members:[],head:void 0});let e=l.get(a.kkNumber);e.members.push(a),"Kepala Keluarga"===a.familyRelationship&&(e.head=a)}let n=[];for(let[e,a]of l.entries())if(a.head){let l=a.head.familyMembersCount,s=a.members.length;s<l&&n.push({kkNumber:e,headOfFamily:a.head.name,expectedCount:l,currentCount:s,rt:a.head.rt,rw:a.head.rw,username:a.head.username})}a(n)}catch(e){console.error("Failed to fetch and process family data:",e),c({title:"Gagal Mengambil Data",description:"Tidak dapat memproses data keluarga.",variant:"destructive"})}finally{r(!1)}})()},[c]);let d=(0,s.useMemo)(()=>e.slice(0,t),[e,t]);return(0,n.jsxs)(h.Zp,{children:[(0,n.jsxs)(h.aR,{className:"flex flex-row items-center justify-between",children:[(0,n.jsx)(h.ZB,{children:"Keluarga Belum Lengkap"}),(0,n.jsxs)(P.$,{onClick:()=>{let a=e.map(e=>({"Kepala Keluarga":e.headOfFamily,"No. KK":e.kkNumber,"RT/RW":"".concat(e.rt,"/").concat(e.rw),"Anggota Dientri":e.currentCount,"Anggota Diharapkan":e.expectedCount,Kekurangan:e.expectedCount-e.currentCount,Penginput:e.username})),l=$.Wp.json_to_sheet(a),n=$.Wp.book_new();$.Wp.book_append_sheet(n,l,"Keluarga Belum Lengkap"),$._h(n,"keluarga_belum_lengkap.xlsx")},className:"bg-accent text-accent-foreground hover:bg-accent/90",disabled:l||0===e.length,children:[(0,n.jsx)(G.A,{className:"mr-2 h-4 w-4"}),"Download XLS"]})]}),(0,n.jsxs)(h.Wu,{children:[(0,n.jsxs)(I.XI,{children:[(0,n.jsx)(I.A0,{children:(0,n.jsxs)(I.Hj,{children:[(0,n.jsx)(I.nd,{children:"Kepala Keluarga"}),(0,n.jsx)(I.nd,{children:"No. KK"}),(0,n.jsx)(I.nd,{children:"RT/RW"}),(0,n.jsx)(I.nd,{children:"Penginput"}),(0,n.jsx)(I.nd,{className:"w-[250px]",children:"Progres Entri"})]})}),(0,n.jsx)(I.BF,{children:l?Array.from({length:3}).map((e,a)=>(0,n.jsxs)(I.Hj,{children:[(0,n.jsx)(I.nA,{children:(0,n.jsx)(S.E,{className:"h-4 w-32"})}),(0,n.jsx)(I.nA,{children:(0,n.jsx)(S.E,{className:"h-4 w-40"})}),(0,n.jsx)(I.nA,{children:(0,n.jsx)(S.E,{className:"h-4 w-16"})}),(0,n.jsx)(I.nA,{children:(0,n.jsx)(S.E,{className:"h-4 w-24"})}),(0,n.jsx)(I.nA,{children:(0,n.jsx)(S.E,{className:"h-4 w-48"})})]},a)):d.length>0?d.map(e=>(0,n.jsxs)(I.Hj,{children:[(0,n.jsx)(I.nA,{className:"font-medium",children:e.headOfFamily}),(0,n.jsx)(I.nA,{children:e.kkNumber}),(0,n.jsx)(I.nA,{children:"".concat(e.rt,"/").concat(e.rw)}),(0,n.jsx)(I.nA,{children:e.username}),(0,n.jsx)(I.nA,{children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(J.k,{value:e.currentCount/e.expectedCount*100,className:"w-40"}),(0,n.jsx)("span",{className:"text-muted-foreground text-xs",children:"".concat(e.currentCount," dari ").concat(e.expectedCount)})]})})]},e.kkNumber)):(0,n.jsx)(I.Hj,{children:(0,n.jsx)(I.nA,{colSpan:5,className:"h-24 text-center",children:"Semua data keluarga sudah lengkap."})})})]}),e.length>5&&(0,n.jsx)("div",{className:"mt-4 flex justify-center",children:t<e.length?(0,n.jsxs)(P.$,{onClick:()=>{i(e=>e+5)},variant:"outline",children:["Tampilkan lebih banyak (",e.length-t," lagi)"]}):(0,n.jsx)(P.$,{onClick:()=>{i(5)},variant:"outline",children:"Tampilkan lebih sedikit"})})]})]})}var U=l(22346);function q(){let e=(0,z.useRouter)(),[a,l]=(0,s.useState)(null),[r,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("username");e&&l(await (0,K.aU)(e))})()},[r]),(0,n.jsxs)("div",{className:"relative flex flex-col min-h-screen",style:{backgroundImage:"url('https://images.unsplash.com/photo-1506792006437-256b665541e2?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTF8fHdhcm5hfGVufDB8fDB8fHww')",backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"},children:[(0,n.jsx)("div",{className:"absolute inset-0 bg-black/30 z-0"}),(0,n.jsxs)("div",{className:"relative z-10 flex flex-col flex-grow",children:[(0,n.jsx)("header",{className:"sticky top-0 z-10 w-full bg-card/80 backdrop-blur-sm border-b",children:(0,n.jsxs)("div",{className:"container flex items-center justify-between h-16 px-4 mx-auto sm:px-6 lg:px-8",children:[(0,n.jsx)(O.a,{}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(P.$,{variant:"outline",onClick:()=>e.push("/admin/citizens"),children:[(0,n.jsx)(B.A,{}),(0,n.jsx)("span",{children:"Data Warga"})]}),(0,n.jsxs)(P.$,{variant:"outline",onClick:()=>e.push("/admin/users"),children:[(0,n.jsx)(y.A,{}),(0,n.jsx)("span",{children:"Data Pengguna"})]}),(0,n.jsxs)(P.$,{variant:"outline",onClick:()=>e.push("/admin"),children:[(0,n.jsx)(M.A,{}),(0,n.jsx)("span",{children:"Dasbor"})]}),(0,n.jsxs)(P.$,{variant:"outline",onClick:()=>t(!0),disabled:!a,children:[(0,n.jsx)(W.A,{}),(0,n.jsx)("span",{children:"Edit Profil"})]}),(0,n.jsxs)(P.$,{variant:"destructive",onClick:()=>{localStorage.removeItem("userRole"),localStorage.removeItem("username"),e.push("/login")},children:[(0,n.jsx)(F.A,{size:16}),(0,n.jsx)("span",{children:"Keluar"})]})]})]})}),(0,n.jsx)("main",{className:"container px-4 py-8 mx-auto sm:px-6 lg:px-8 flex-grow",children:(0,n.jsxs)("div",{className:"space-y-8 bg-card/80 backdrop-blur-sm p-6 rounded-lg shadow-lg",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold font-headline tracking-tight",children:"Dasbor Admin"}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:"Selamat datang! Berikut adalah ringkasan data warga."})]}),(0,n.jsx)(R,{}),(0,n.jsx)(U.w,{}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)(X,{})})})]})})]}),(0,n.jsx)(T.lG,{open:r,onOpenChange:t,children:(0,n.jsxs)(T.Cf,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(T.c7,{children:[(0,n.jsx)(T.L3,{children:"Edit Profil"}),(0,n.jsx)(T.rr,{children:"Lakukan perubahan pada data profil Anda. Klik simpan jika sudah selesai."})]}),a&&(0,n.jsx)(H.S,{user:a,onSuccess:()=>{t(!1)},isEditingSelf:!0})]})})]})}},22346:(e,a,l)=>{"use strict";l.d(a,{w:()=>i});var n=l(95155),s=l(12115),r=l(87489),t=l(59434);let i=s.forwardRef((e,a)=>{let{className:l,orientation:s="horizontal",decorative:i=!0,...c}=e;return(0,n.jsx)(r.b,{ref:a,decorative:i,orientation:s,className:(0,t.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",l),...c})});i.displayName=r.b.displayName},24944:(e,a,l)=>{"use strict";l.d(a,{k:()=>i});var n=l(95155),s=l(12115),r=l(55863),t=l(59434);let i=s.forwardRef((e,a)=>{let{className:l,value:s,...i}=e;return(0,n.jsx)(r.bL,{ref:a,className:(0,t.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...i,children:(0,n.jsx)(r.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});i.displayName=r.bL.displayName},32383:()=>{},65573:(e,a,l)=>{Promise.resolve().then(l.bind(l,19448))},83686:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[992,524,172,320,869,192,63,915,225,730,448,441,684,358],()=>a(65573)),_N_E=e.O()}]);