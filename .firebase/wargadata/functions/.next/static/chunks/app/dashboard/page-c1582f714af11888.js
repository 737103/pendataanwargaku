(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{11066:(e,a,l)=>{"use strict";l.d(a,{MyDataClient:()=>v});var n=l(95155),s=l(12115),r=l(85174),i=l(85127),t=l(90010),d=l(54165),c=l(66695),o=l(68856),h=l(30285),u=l(75074),m=l(17607),x=l(75943),j=l(77223),g=l(87481),p=l(97419),k=l(47727),f=l(62523);function v(){let[e,a]=(0,s.useState)([]),[l,v]=(0,s.useState)(!0),[b,N]=(0,s.useState)(null),[y,w]=(0,s.useState)(null),[C,A]=(0,s.useState)(null),[I,K]=(0,s.useState)(!1),[S,R]=(0,s.useState)(!1),[z,T]=(0,s.useState)(!1),[M,E]=(0,s.useState)(""),[B,L]=(0,s.useState)(5),{toast:P}=(0,g.dj)(),D=(0,s.useCallback)(async()=>{v(!0);let e=localStorage.getItem("username");if(!e){P({title:"Error",description:"Anda harus login untuk melihat data ini.",variant:"destructive"}),v(!1);return}try{let l=await (0,r.ZL)(e);a(l)}catch(e){console.error("Failed to fetch user citizens:",e),P({title:"Gagal Mengambil Data",description:"Tidak dapat mengambil daftar data Anda.",variant:"destructive"})}finally{v(!1)}},[P]);(0,s.useEffect)(()=>{D()},[D]);let V=(0,s.useMemo)(()=>M?e.filter(e=>e.name.toLowerCase().includes(M.toLowerCase())||e.nik.includes(M)||e.kkNumber.includes(M)):e,[e,M]),J=(0,s.useMemo)(()=>V.slice(0,B),[V,B]),F=e=>{N(e),K(!0)},H=e=>{w(e),R(!0)},O=e=>{A(e),T(!0)},W=async()=>{if(b)try{await (0,r.uV)(b.id),P({title:"Data Dihapus",description:'Data untuk "'.concat(b.name,'" telah berhasil dihapus.')}),D()}catch(e){console.error("Failed to delete citizen data:",e),P({title:"Gagal Menghapus",description:"Terjadi kesalahan saat menghapus data.",variant:"destructive"})}finally{K(!1),N(null)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.Zp,{children:[(0,n.jsx)(c.aR,{children:(0,n.jsx)(c.ZB,{children:"Data Saya"})}),(0,n.jsxs)(c.Wu,{children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(u.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,n.jsx)(f.p,{placeholder:"Cari berdasarkan Nama, NIK, atau No. KK...",value:M,onChange:e=>E(e.target.value),className:"pl-10"})]})}),(0,n.jsxs)(i.XI,{children:[(0,n.jsx)(i.A0,{children:(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nd,{children:"Nama"}),(0,n.jsx)(i.nd,{children:"NIK"}),(0,n.jsx)(i.nd,{children:"No. KK"}),(0,n.jsx)(i.nd,{children:"Hubungan Keluarga"}),(0,n.jsx)(i.nd,{children:"Alamat"}),(0,n.jsx)(i.nd,{children:"No. Telepon"}),(0,n.jsx)(i.nd,{children:"Dokumen"}),(0,n.jsx)(i.nd,{className:"text-right",children:"Aksi"})]})}),(0,n.jsx)(i.BF,{children:l?Array.from({length:3}).map((e,a)=>(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-32"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-36"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-36"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-24"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-48"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-28"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(o.E,{className:"h-4 w-24"})}),(0,n.jsx)(i.nA,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(o.E,{className:"h-8 w-8"}),(0,n.jsx)(o.E,{className:"h-8 w-8"}),(0,n.jsx)(o.E,{className:"h-8 w-8"})]})})]},a)):J.length>0?J.map(e=>(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nA,{className:"font-medium",children:e.name}),(0,n.jsx)(i.nA,{children:e.nik}),(0,n.jsx)(i.nA,{children:e.kkNumber}),(0,n.jsx)(i.nA,{children:e.familyRelationship}),(0,n.jsx)(i.nA,{children:e.address}),(0,n.jsx)(i.nA,{children:e.contactInfo}),(0,n.jsx)(i.nA,{children:e.documents&&e.documents.length>0?"Dokumen Terunggah":"Tidak ada"}),(0,n.jsx)(i.nA,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsxs)(h.$,{variant:"outline",size:"icon",onClick:()=>O(e),title:"Lihat Detail",children:[(0,n.jsx)(m.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Lihat Detail"})]}),(0,n.jsxs)(h.$,{variant:"outline",size:"icon",onClick:()=>H(e),title:"Edit",children:[(0,n.jsx)(x.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,n.jsxs)(h.$,{variant:"destructive",size:"icon",onClick:()=>F(e),title:"Hapus",children:[(0,n.jsx)(j.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Hapus"})]})]})})]},e.id)):(0,n.jsx)(i.Hj,{children:(0,n.jsx)(i.nA,{colSpan:8,className:"h-24 text-center",children:M?'Tidak ada data yang cocok dengan "'.concat(M,'".'):"Anda belum mengentri data."})})})]}),V.length>5&&(0,n.jsx)("div",{className:"mt-4 flex justify-center",children:B<V.length?(0,n.jsxs)(h.$,{onClick:()=>{L(e=>e+5)},variant:"outline",children:["Tampilkan lebih banyak (",V.length-B," lagi)"]}):(0,n.jsx)(h.$,{onClick:()=>{L(5)},variant:"outline",children:"Tampilkan lebih sedikit"})})]})]}),(0,n.jsx)(t.Lt,{open:I,onOpenChange:K,children:(0,n.jsxs)(t.EO,{children:[(0,n.jsxs)(t.wd,{children:[(0,n.jsx)(t.r7,{children:"Anda Yakin?"}),(0,n.jsxs)(t.$v,{children:['Tindakan ini akan menghapus data untuk "',null==b?void 0:b.name,'" secara permanen.']})]}),(0,n.jsxs)(t.ck,{children:[(0,n.jsx)(t.Zr,{children:"Batal"}),(0,n.jsx)(t.Rx,{onClick:W,children:"Hapus"})]})]})}),(0,n.jsx)(d.lG,{open:S,onOpenChange:R,children:(0,n.jsxs)(d.Cf,{className:"sm:max-w-[650px]",children:[(0,n.jsxs)(d.c7,{children:[(0,n.jsx)(d.L3,{children:"Edit Data Warga"}),(0,n.jsx)(d.rr,{children:"Lakukan perubahan pada data Anda. Klik simpan jika sudah selesai."})]}),y&&(0,n.jsx)(p.P,{citizen:y,onSuccess:()=>{R(!1),w(null),D()}})]})}),(0,n.jsx)(d.lG,{open:z,onOpenChange:T,children:(0,n.jsxs)(d.Cf,{className:"sm:max-w-[650px]",children:[(0,n.jsxs)(d.c7,{children:[(0,n.jsx)(d.L3,{children:"Detail Data Warga"}),(0,n.jsx)(d.rr,{children:"Informasi lengkap mengenai data yang Anda entri."})]}),C&&(0,n.jsx)(k.F,{citizen:C})]})})]})}},13262:(e,a,l)=>{"use strict";l.d(a,{a:()=>r});var n=l(95155),s=l(66766);function r(){return(0,n.jsxs)("div",{className:"flex items-center gap-2 font-headline text-lg font-bold",children:[(0,n.jsx)("div",{className:"relative h-[80px] w-[80px]",children:(0,n.jsx)(s.default,{src:"/logo-wargadata.png",alt:"WargaKu Logo",fill:!0,className:"object-contain","data-ai-hint":"logo"})}),(0,n.jsx)("span",{children:"WargaKu"})]})}},22346:(e,a,l)=>{"use strict";l.d(a,{Separator:()=>t});var n=l(95155),s=l(12115),r=l(87489),i=l(59434);let t=s.forwardRef((e,a)=>{let{className:l,orientation:s="horizontal",decorative:t=!0,...d}=e;return(0,n.jsx)(r.b,{ref:a,decorative:t,orientation:s,className:(0,i.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",l),...d})});t.displayName=r.b.displayName},24944:(e,a,l)=>{"use strict";l.d(a,{k:()=>t});var n=l(95155),s=l(12115),r=l(55863),i=l(59434);let t=s.forwardRef((e,a)=>{let{className:l,value:s,...t}=e;return(0,n.jsx)(r.bL,{ref:a,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...t,children:(0,n.jsx)(r.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});t.displayName=r.bL.displayName},43183:(e,a,l)=>{Promise.resolve().then(l.bind(l,59129)),Promise.resolve().then(l.bind(l,77033)),Promise.resolve().then(l.bind(l,92352)),Promise.resolve().then(l.bind(l,11066)),Promise.resolve().then(l.bind(l,89063)),Promise.resolve().then(l.bind(l,22346))},59129:(e,a,l)=>{"use strict";l.d(a,{CitizenForm:()=>L});var n=l(95155),s=l(90221),r=l(62177),i=l(55594),t=l(12115),d=l(63974),c=l(30285),o=l(17759),h=l(59409),u=l(30356),m=l(62523),x=l(88539),j=l(66695),g=l(74466),p=l(59434);let k=(0,g.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),f=t.forwardRef((e,a)=>{let{className:l,variant:s,...r}=e;return(0,n.jsx)("div",{ref:a,role:"alert",className:(0,p.cn)(k({variant:s}),l),...r})});f.displayName="Alert";let v=t.forwardRef((e,a)=>{let{className:l,...s}=e;return(0,n.jsx)("h5",{ref:a,className:(0,p.cn)("mb-1 font-medium leading-none tracking-tight",l),...s})});v.displayName="AlertTitle";let b=t.forwardRef((e,a)=>{let{className:l,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,p.cn)("text-sm [&_p]:leading-relaxed",l),...s})});b.displayName="AlertDescription";var N=l(34477);let y=(0,N.createServerReference)("40b29334c9f529515726bd4c1242a242ad78628568",N.callServer,void 0,N.findSourceMapURL,"validateCitizenData");var w=l(16923),C=l(26955),A=l(11133),I=l(50172),K=l(87481),S=l(85174),R=l(35695);let z=["image/jpeg","image/jpg","image/png"],T=/^00\d{1,2}$/,M=["Belum/Tidak Bekerja","Mengurus Rumah Tangga","Karyawan Swasta","Pegawai Negeri Sipil","ASN P3K","Honorer","Buruh Harian Lepas","Wiraswasta","Pedagang","Petani","Lainnya"],E=()=>i.z.object({name:i.z.string().min(1,"Nama tidak boleh kosong."),nik:i.z.string().length(16,"NIK harus 16 digit.").regex(/^\d+$/,"NIK harus berupa angka."),kkNumber:i.z.string().length(16,"No. KK harus 16 digit.").regex(/^\d+$/,"No. KK harus berupa angka."),address:i.z.string().min(1,"Alamat tidak boleh kosong."),rt:i.z.string().min(3,"RT minimal 3 digit").max(4,"RT maksimal 4 digit").regex(T,"Format RT tidak valid (cth: 001)"),rw:i.z.string().min(3,"RW minimal 3 digit").max(4,"RW maksimal 4 digit").regex(T,"Format RW tidak valid (cth: 001)"),contactInfo:i.z.string().min(10,"Info kontak harus memiliki setidaknya 10 karakter.").max(15,"Info kontak tidak boleh lebih dari 15 karakter."),gender:i.z.enum(["Laki-laki","Perempuan"],{required_error:"Jenis kelamin harus dipilih."}),bloodType:i.z.string({required_error:"Golongan darah harus dipilih."}).refine(e=>""!==e,"Golongan darah harus dipilih."),occupation:i.z.string({required_error:"Pekerjaan harus dipilih."}),otherOccupation:i.z.string().optional(),lastEducation:i.z.string({required_error:"Pendidikan terakhir harus dipilih."}),religion:i.z.string({required_error:"Agama harus dipilih."}),maritalStatus:i.z.string({required_error:"Status perkawinan harus dipilih."}),familyRelationship:i.z.string({required_error:"Hubungan dalam keluarga harus dipilih."}),familyMembersCount:i.z.coerce.number().min(1,"Jumlah anggota keluarga minimal 1."),documents:i.z.any().optional().refine(e=>{var a;return!e||0===e.length||(null==e||null==(a=e[0])?void 0:a.size)<=512e3},"Ukuran file maksimal adalah 500 KB.").refine(e=>{var a;return!e||0===e.length||z.includes(null==e||null==(a=e[0])?void 0:a.type)},"Hanya format .jpg, .jpeg, dan .png yang diterima.")}).refine(e=>"Lainnya"!==e.occupation||!!e.otherOccupation&&e.otherOccupation.trim().length>0,{message:"Pekerjaan lainnya harus diisi",path:["otherOccupation"]}).refine(e=>"Kepala Keluarga"!==e.familyRelationship||e.documents&&e.documents.length>0,{message:"Dokumen wajib diunggah untuk Kepala Keluarga.",path:["documents"]}).superRefine(async(e,a)=>{if(16===e.nik.length&&/^\d+$/.test(e.nik))try{await (0,S.Fo)(e.nik)&&a.addIssue({code:i.z.ZodIssueCode.custom,message:"NIK ini sudah terdaftar.",path:["nik"]})}catch(e){console.error("NIK validation failed:",e)}}),B=e=>new Promise((a,l)=>{let n=new FileReader;n.onload=()=>a(n.result),n.onerror=l,n.readAsDataURL(e)});function L(){let[e,a]=(0,t.useState)(!1),[l,i]=(0,t.useState)(null),{toast:g}=(0,K.dj)(),p=(0,R.useRouter)(),[k,N]=(0,t.useState)(!1),z=E(),T=(0,r.mN)({resolver:(0,s.u)(z,{mode:"onChange"}),defaultValues:{name:"",nik:"",kkNumber:"",address:"",rt:"",rw:"",contactInfo:"",familyMembersCount:1,otherOccupation:"",bloodType:""}}),L=T.watch("occupation"),P=T.watch("familyRelationship"),D=T.watch("kkNumber"),[V]=(0,d.d7)(D,500),J=(0,t.useCallback)(async e=>{if(16!==e.length||!/^\d+$/.test(e))return void N(!1);let a=await (0,S.jw)(e);a?(T.setValue("address",a.address,{shouldValidate:!0}),T.setValue("rt",a.rt,{shouldValidate:!0}),T.setValue("rw",a.rw,{shouldValidate:!0}),T.setValue("familyMembersCount",a.familyMembersCount,{shouldValidate:!0}),N(!0),k||g({title:"No. KK Ditemukan",description:"Data keluarga (Alamat, RT, RW, dll) telah diisi otomatis."})):(k&&(T.resetField("address"),T.resetField("rt"),T.resetField("rw"),T.resetField("familyMembersCount")),N(!1))},[T,g,k]);async function F(e){var l,n;a(!0),i(null);let s=[];if((null==(l=e.documents)?void 0:l.length)>0)try{let a=await B(e.documents[0]);s.push(a)}catch(e){console.error("Error converting file to data URI:",e),g({title:"File Error",description:"Gagal memproses file yang diunggah.",variant:"destructive"}),a(!1);return}try{let a=(null==(n=e.documents)?void 0:n.length)>0?[e.documents[0].name]:[],l=await y({name:e.name,address:e.address,contactInfo:e.contactInfo,documents:a,nik:e.nik,kkNumber:e.kkNumber,bloodType:e.bloodType,rt:e.rt,rw:e.rw});if(i(l),l.isValid){let a=localStorage.getItem("username");if(!a)throw g({title:"Otentikasi Gagal",description:"Username tidak ditemukan. Silakan login kembali.",variant:"destructive"}),Error("User not logged in");let l="Lainnya"===e.occupation?e.otherOccupation:e.occupation,{otherOccupation:n,...r}=e;await (0,S.GY)({...r,occupation:l,documents:s,username:a}),g({title:"Data Terkirim",description:"Data Anda telah berhasil divalidasi dan disimpan.",variant:"default"}),T.reset(),N(!1),p.refresh()}}catch(e){console.error("Validation or submission error:",e),e.message&&(e.message.includes("503 Service Unavailable")||e.message.includes("overloaded"))?g({title:"Layanan Validasi Sedang Sibuk",description:"Layanan validasi AI sedang mengalami beban tinggi. Silakan coba kirimkan kembali dalam beberapa saat.",variant:"destructive"}):g({title:"Terjadi Kesalahan",description:"Tidak dapat memvalidasi atau mengirim data saat ini. Coba lagi nanti.",variant:"destructive"})}finally{a(!1)}}return(0,t.useEffect)(()=>{J(V)},[V,J]),(0,n.jsx)(j.Zp,{children:(0,n.jsx)(j.Wu,{className:"pt-6",children:(0,n.jsx)(o.lV,{...T,children:(0,n.jsxs)("form",{onSubmit:T.handleSubmit(F),className:"space-y-8",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsx)(o.zB,{control:T.control,name:"name",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Nama Lengkap"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"cth. Budi Santoso",...a})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"nik",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"NIK"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"16 digit NIK",...a})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"kkNumber",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"No. KK"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"16 digit No. KK",...a})}),(0,n.jsx)(o.Rr,{children:"Jika No. KK sudah ada, data keluarga akan diisi otomatis."}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"contactInfo",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Nomor Telepon"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"cth. 081234567890",...a})}),(0,n.jsx)(o.C5,{})]})}})]}),(0,n.jsx)(o.zB,{control:T.control,name:"address",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Alamat Lengkap"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(x.T,{placeholder:"cth. Jl. Pahlawan No. 10, Semarang",...a,disabled:k})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsx)(o.zB,{control:T.control,name:"rt",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"RT"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"cth. 001",...a,disabled:k})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"rw",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"RW"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"cth. 002",...a,disabled:k})}),(0,n.jsx)(o.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsx)(o.zB,{control:T.control,name:"gender",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{className:"space-y-3",children:[(0,n.jsx)(o.lR,{children:"Jenis Kelamin"}),(0,n.jsx)(o.MJ,{children:(0,n.jsxs)(u.z,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex-col space-y-1",children:[(0,n.jsxs)(o.eI,{className:"flex items-center space-x-3 space-y-0",children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(u.C,{value:"Laki-laki"})}),(0,n.jsx)(o.lR,{className:"font-normal",children:"Laki-laki"})]}),(0,n.jsxs)(o.eI,{className:"flex items-center space-x-3 space-y-0",children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(u.C,{value:"Perempuan"})}),(0,n.jsx)(o.lR,{className:"font-normal",children:"Perempuan"})]})]})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"bloodType",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Golongan Darah"}),(0,n.jsxs)(h.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(h.bq,{children:(0,n.jsx)(h.yv,{placeholder:"Pilih golongan darah"})})}),(0,n.jsxs)(h.gC,{children:[(0,n.jsx)(h.eb,{value:"A",children:"A"}),(0,n.jsx)(h.eb,{value:"B",children:"B"}),(0,n.jsx)(h.eb,{value:"AB",children:"AB"}),(0,n.jsx)(h.eb,{value:"O",children:"O"}),(0,n.jsx)(h.eb,{value:"Tidak tahu",children:"Tidak tahu"})]})]}),(0,n.jsx)(o.C5,{})]})}})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsx)(o.zB,{control:T.control,name:"occupation",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Pekerjaan"}),(0,n.jsxs)(h.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(h.bq,{children:(0,n.jsx)(h.yv,{placeholder:"Pilih pekerjaan"})})}),(0,n.jsx)(h.gC,{children:M.map(e=>(0,n.jsx)(h.eb,{value:e,children:e},e))})]}),(0,n.jsx)(o.C5,{})]})}}),"Lainnya"===L&&(0,n.jsx)(o.zB,{control:T.control,name:"otherOccupation",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Pekerjaan Lainnya"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{placeholder:"Sebutkan pekerjaan",...a})}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"lastEducation",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Pendidikan Terakhir"}),(0,n.jsxs)(h.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(h.bq,{children:(0,n.jsx)(h.yv,{placeholder:"Pilih pendidikan"})})}),(0,n.jsxs)(h.gC,{children:[(0,n.jsx)(h.eb,{value:"Tidak-belum sekolah",children:"Tidak-belum sekolah"}),(0,n.jsx)(h.eb,{value:"Tamat SD-sederajat",children:"Tamat SD-sederajat"}),(0,n.jsx)(h.eb,{value:"Tamat SLTP-sederajat",children:"Tamat SLTP-sederajat"}),(0,n.jsx)(h.eb,{value:"Tamat SLTA-sederajat",children:"Tamat SLTA-sederajat"}),(0,n.jsx)(h.eb,{value:"Diploma III",children:"Diploma III"}),(0,n.jsx)(h.eb,{value:"Diploma III-sarjana Muda",children:"Diploma III-sarjana Muda"}),(0,n.jsx)(h.eb,{value:"Strata I-Sarjana",children:"Strata I-Sarjana"}),(0,n.jsx)(h.eb,{value:"Strata II-Magister",children:"Strata II-Magister"}),(0,n.jsx)(h.eb,{value:"Strata III-Doktor",children:"Strata III-Doktor"})]})]}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"religion",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Agama"}),(0,n.jsxs)(h.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(h.bq,{children:(0,n.jsx)(h.yv,{placeholder:"Pilih agama"})})}),(0,n.jsxs)(h.gC,{children:[(0,n.jsx)(h.eb,{value:"Islam",children:"Islam"}),(0,n.jsx)(h.eb,{value:"Kristen",children:"Kristen"}),(0,n.jsx)(h.eb,{value:"Katolik",children:"Katolik"}),(0,n.jsx)(h.eb,{value:"Hindu",children:"Hindu"}),(0,n.jsx)(h.eb,{value:"Buddha",children:"Buddha"}),(0,n.jsx)(h.eb,{value:"Khonghucu",children:"Khonghucu"})]})]}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"maritalStatus",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Status Perkawinan"}),(0,n.jsxs)(h.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(h.bq,{children:(0,n.jsx)(h.yv,{placeholder:"Pilih status"})})}),(0,n.jsxs)(h.gC,{children:[(0,n.jsx)(h.eb,{value:"Belum Kawin",children:"Belum Kawin"}),(0,n.jsx)(h.eb,{value:"Kawin",children:"Kawin"}),(0,n.jsx)(h.eb,{value:"Cerai Hidup",children:"Cerai Hidup"}),(0,n.jsx)(h.eb,{value:"Cerai Mati",children:"Cerai Mati"})]})]}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"familyRelationship",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Hubungan dalam Keluarga"}),(0,n.jsxs)(h.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,n.jsx)(o.MJ,{children:(0,n.jsx)(h.bq,{children:(0,n.jsx)(h.yv,{placeholder:"Pilih hubungan"})})}),(0,n.jsxs)(h.gC,{children:[(0,n.jsx)(h.eb,{value:"Kepala Keluarga",children:"Kepala Keluarga"}),(0,n.jsx)(h.eb,{value:"Istri",children:"Istri"}),(0,n.jsx)(h.eb,{value:"Anak",children:"Anak"}),(0,n.jsx)(h.eb,{value:"Family Lainnya",children:"Family Lainnya"})]})]}),(0,n.jsx)(o.C5,{})]})}}),(0,n.jsx)(o.zB,{control:T.control,name:"familyMembersCount",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Jumlah Anggota Keluarga"}),(0,n.jsx)(o.MJ,{children:(0,n.jsx)(m.p,{type:"number",placeholder:"cth. 4",...a,disabled:k})}),(0,n.jsx)(o.C5,{})]})}})]}),"Kepala Keluarga"===P&&(0,n.jsx)(o.zB,{control:T.control,name:"documents",render:e=>{let{field:a}=e;return(0,n.jsxs)(o.eI,{children:[(0,n.jsx)(o.lR,{children:"Upload Dokumen (KTP/KK)"}),(0,n.jsx)(o.MJ,{children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(w.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,n.jsx)(m.p,{type:"file",className:"pl-10",onChange:e=>a.onChange(e.target.files),accept:"image/png, image/jpeg, image/jpg"})]})}),(0,n.jsx)(o.Rr,{children:"Unggah pindaian dokumen Anda dalam format JPG atau PNG (maks. 500 KB)."}),(0,n.jsx)(o.C5,{})]})}}),l&&(0,n.jsxs)(f,{variant:l.isValid?"default":"destructive",className:l.isValid?"border-green-500 text-green-600":"",children:[l.isValid?(0,n.jsx)(C.A,{className:"h-4 w-4"}):(0,n.jsx)(A.A,{className:"h-4 w-4"}),(0,n.jsx)(v,{children:l.isValid?"Validasi Berhasil":"Validasi Gagal"}),(0,n.jsx)(b,{children:l.isValid?"Data Anda terlihat bagus dan siap untuk diproses.":(0,n.jsx)("ul",{children:l.validationErrors.map((e,a)=>(0,n.jsx)("li",{className:"list-disc ml-4",children:e},a))})})]}),(0,n.jsxs)(c.$,{type:"submit",disabled:e,className:"w-full bg-accent text-accent-foreground hover:bg-accent/90",children:[e&&(0,n.jsx)(I.A,{className:"mr-2 h-4 w-4 animate-spin"}),e?"Memvalidasi...":"Validasi & Kirim"]})]})})})})}},77033:(e,a,l)=>{"use strict";l.d(a,{DashboardHeader:()=>d});var n=l(95155),s=l(30285),r=l(13262),i=l(33349),t=l(35695);function d(){let e=(0,t.useRouter)();return(0,n.jsxs)("header",{className:"flex items-center justify-between w-full",children:[(0,n.jsx)(r.a,{}),(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsxs)(s.$,{variant:"destructive",onClick:()=>{localStorage.removeItem("userRole"),localStorage.removeItem("username"),e.push("/login")},children:[(0,n.jsx)(i.A,{size:16}),(0,n.jsx)("span",{children:"Keluar"})]})})]})}},89063:(e,a,l)=>{"use strict";l.d(a,{ReportClient:()=>v});var n=l(95155),s=l(12115),r=l(83540),i=l(8782),t=l(34e3),d=l(54811),c=l(94517),o=l(24026),h=l(66695),u=l(50286),m=l(68510),x=l(18186),j=l(8376),g=l(85174),p=l(68856),k=l(87481);function f(e){let{title:a,value:l,icon:s,loading:r}=e;return(0,n.jsxs)(h.Zp,{children:[(0,n.jsxs)(h.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(h.ZB,{className:"text-sm font-medium",children:a}),(0,n.jsx)(s,{className:"h-4 w-4 text-muted-foreground"})]}),(0,n.jsx)(h.Wu,{children:r?(0,n.jsx)(p.E,{className:"h-8 w-24"}):(0,n.jsx)("div",{className:"text-2xl font-bold",children:l})})]})}function v(){var e,a,l,v;let[b,N]=(0,s.useState)(null),[y,w]=(0,s.useState)(!0),[C,A]=(0,s.useState)(""),{toast:I}=(0,k.dj)();(0,s.useEffect)(()=>{!async function(){w(!0);let e=localStorage.getItem("username");if(!e){I({title:"Error",description:"Anda harus login untuk melihat data ini.",variant:"destructive"}),w(!1);return}try{let[a,l]=await Promise.all([(0,g.bi)(e),(0,g.aU)(e)]);N(a),l&&A(l.name)}catch(e){console.error("Failed to fetch user dashboard stats:",e),I({title:"Gagal Mengambil Laporan",description:"Terjadi kesalahan saat memuat data laporan Anda.",variant:"destructive"})}finally{w(!1)}}()},[I]);let K=(null==b?void 0:b.completionData)||[],S=K.reduce((e,a)=>e+a.value,0);return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-3xl font-bold font-headline tracking-tight",children:["Laporan Data Saya: ",y?(0,n.jsx)(p.E,{className:"h-8 w-48 inline-block"}):(0,n.jsx)("span",{children:C})]}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:"Berikut adalah ringkasan data yang telah Anda entri."})]}),(0,n.jsxs)("div",{className:"grid gap-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,n.jsx)(f,{title:"Jumlah Jiwa (Entri Saya)",value:null!=(e=null==b?void 0:b.totalSouls)?e:0,icon:u.A,loading:y}),(0,n.jsx)(f,{title:"Jumlah Laki-laki (Entri Saya)",value:null!=(a=null==b?void 0:b.totalMale)?a:0,icon:m.A,loading:y}),(0,n.jsx)(f,{title:"Jumlah Perempuan (Entri Saya)",value:null!=(l=null==b?void 0:b.totalFemale)?l:0,icon:m.A,loading:y}),(0,n.jsx)(f,{title:"Jumlah KK (Entri Saya)",value:null!=(v=null==b?void 0:b.totalKK)?v:0,icon:x.A,loading:y})]}),(0,n.jsxs)(h.Zp,{children:[(0,n.jsxs)(h.aR,{children:[(0,n.jsx)(h.ZB,{children:"Kelengkapan Anggota Keluarga (Entri Saya)"}),(0,n.jsx)(h.BT,{children:"Persentase jumlah anggota keluarga yang telah Anda input dibandingkan dengan yang belum."})]}),(0,n.jsx)(h.Wu,{children:y?(0,n.jsx)("div",{className:"h-[300px] w-full flex items-center justify-center",children:(0,n.jsx)(p.E,{className:"h-full w-full"})}):S>0?(0,n.jsx)("div",{className:"min-h-[300px] w-full",children:(0,n.jsx)(r.u,{width:"100%",height:300,children:(0,n.jsxs)(i.r,{children:[(0,n.jsx)(t.F,{data:K,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:e=>{let{name:a,percent:l}=e;return"".concat(a," ").concat((100*l).toFixed(0),"%")},children:K.map((e,a)=>(0,n.jsx)(d.f,{fill:e.color},"cell-".concat(a)))}),(0,n.jsx)(c.m,{formatter:(e,a)=>["".concat(e," orang"),a]}),(0,n.jsx)(o.s,{})]})})}):(0,n.jsxs)("div",{className:"h-[300px] flex flex-col items-center justify-center text-center",children:[(0,n.jsx)(j.A,{className:"h-12 w-12 text-green-500 mb-4"}),(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Data Lengkap!"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Semua anggota keluarga dari data yang Anda entri sudah lengkap."})]})})]})]})]})}},92352:(e,a,l)=>{"use strict";l.d(a,{IncompleteFamiliesUserClient:()=>u});var n=l(95155),s=l(12115),r=l(85174),i=l(85127),t=l(66695),d=l(68856),c=l(87481),o=l(24944),h=l(30285);function u(){let[e,a]=(0,s.useState)([]),[l,u]=(0,s.useState)(!0),[m,x]=(0,s.useState)(5),{toast:j}=(0,c.dj)(),g=(0,s.useCallback)(async()=>{u(!0);let e=localStorage.getItem("username");if(!e){j({title:"Error",description:"Anda harus login untuk melihat data ini.",variant:"destructive"}),u(!1);return}try{let l=await (0,r.wO)(),n=l.filter(a=>a.username===e),s=new Map;for(let e of n)s.has(e.kkNumber)||s.set(e.kkNumber,{members:[]});for(let e of l)if(s.has(e.kkNumber)){let a=s.get(e.kkNumber);a.members.push(e),"Kepala Keluarga"===e.familyRelationship&&(a.head=e)}let i=[];for(let[e,a]of s.entries()){let l=a.head;if(l){let n=l.familyMembersCount,s=a.members.length;s<n&&i.push({kkNumber:e,headOfFamily:l.name,expectedCount:n,currentCount:s,rt:l.rt,rw:l.rw})}}a(i)}catch(e){console.error("Failed to fetch and process user family data:",e),j({title:"Gagal Mengambil Data",description:"Tidak dapat memproses data keluarga Anda.",variant:"destructive"})}finally{u(!1)}},[j]);(0,s.useEffect)(()=>{g()},[g]);let p=(0,s.useMemo)(()=>e.slice(0,m),[e,m]);return(0,n.jsx)(t.Zp,{children:(0,n.jsxs)(t.Wu,{className:"pt-6",children:[(0,n.jsxs)(i.XI,{children:[(0,n.jsx)(i.A0,{children:(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nd,{children:"Kepala Keluarga"}),(0,n.jsx)(i.nd,{children:"No. KK"}),(0,n.jsx)(i.nd,{children:"RT/RW"}),(0,n.jsx)(i.nd,{className:"w-[250px]",children:"Progres Entri"})]})}),(0,n.jsx)(i.BF,{children:l?Array.from({length:3}).map((e,a)=>(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nA,{children:(0,n.jsx)(d.E,{className:"h-4 w-32"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(d.E,{className:"h-4 w-40"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(d.E,{className:"h-4 w-16"})}),(0,n.jsx)(i.nA,{children:(0,n.jsx)(d.E,{className:"h-4 w-48"})})]},a)):p.length>0?p.map(e=>(0,n.jsxs)(i.Hj,{children:[(0,n.jsx)(i.nA,{className:"font-medium",children:e.headOfFamily}),(0,n.jsx)(i.nA,{children:e.kkNumber}),(0,n.jsx)(i.nA,{children:"".concat(e.rt,"/").concat(e.rw)}),(0,n.jsx)(i.nA,{children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(o.k,{value:e.currentCount/e.expectedCount*100,className:"w-40"}),(0,n.jsx)("span",{className:"text-muted-foreground text-xs",children:"".concat(e.currentCount," dari ").concat(e.expectedCount)})]})})]},e.kkNumber)):(0,n.jsx)(i.Hj,{children:(0,n.jsx)(i.nA,{colSpan:4,className:"h-24 text-center",children:"Semua data keluarga yang Anda entri sudah lengkap."})})})]}),e.length>5&&(0,n.jsx)("div",{className:"mt-4 flex justify-center",children:m<e.length?(0,n.jsxs)(h.$,{onClick:()=>{x(e=>e+5)},variant:"outline",children:["Tampilkan lebih banyak (",e.length-m," lagi)"]}):(0,n.jsx)(h.$,{onClick:()=>{x(5)},variant:"outline",children:"Tampilkan lebih sedikit"})})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[992,172,320,869,192,63,915,934,590,730,935,441,684,358],()=>a(43183)),_N_E=e.O()}]);